cpu_op_0,cpu_op_0_id,cpu_op_0_input_dim,cpu_op_1,cpu_op_1_id,cpu_op_1_input_dim,kernel,kernel_id,kernel_overhead(us),kernel_dur(us)
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method float of Tensor object at 0x7f37f297e4a0>,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",637770,0,116.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::sum,128954,"[[21528576], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",637810,2.0,84.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::_local_scalar_dense,128957,[[]],Memcpy DtoH (Device -> Pageable),637816,0.3333333333333333,2.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method float of Tensor object at 0x7f37f297e4a0>,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",637832,57.333333333333336,196.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::sum,128962,"[[6144, 6144], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",637848,2.0,126.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,Memcpy DtoH (Device -> Pageable),637854,0.3333333333333333,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",637865,15.0,402.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method sum of Tensor object at 0x7f37f7f948b0>,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",637881,2.0,244.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,Memcpy DtoH (Device -> Pageable),637887,2.0,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",637898,15.0,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",637911,6.666666666666667,4.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,Memcpy DtoH (Device -> Pageable),637917,3.6666666666666665,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",637928,13.666666666666666,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",637941,5.666666666666667,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::item,128992,[[]],Memcpy DtoH (Device -> Pageable),637947,3.6666666666666665,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",637958,12.666666666666666,6.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",637971,5.666666666666667,4.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::item,129001,[[]],Memcpy DtoH (Device -> Pageable),637977,3.0,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",637988,13.0,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",638001,6.0,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::item,129010,[[]],Memcpy DtoH (Device -> Pageable),638007,3.0,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638018,12.666666666666666,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",638031,6.0,4.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::_local_scalar_dense,129020,[[]],Memcpy DtoH (Device -> Pageable),638037,3.0,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638048,12.666666666666666,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",638061,7.333333333333333,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::item,129028,[[]],Memcpy DtoH (Device -> Pageable),638067,3.0,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638078,13.333333333333334,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",638091,6.0,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,Memcpy DtoH (Device -> Pageable),638097,2.6666666666666665,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638108,13.0,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::sum,129044,"[[6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",638121,5.333333333333333,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::_local_scalar_dense,129047,[[]],Memcpy DtoH (Device -> Pageable),638127,5.0,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638138,14.333333333333334,6.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",638151,5.666666666666667,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,Memcpy DtoH (Device -> Pageable),638157,3.0,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638168,14.0,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1980): _has_inf_or_nan,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",638181,6.0,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::_local_scalar_dense,129065,[[]],Memcpy DtoH (Device -> Pageable),638187,4.0,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::copy_,129070,"[[1], [1], []]",Memcpy HtoD (Pageable -> Device),638199,25.666666666666668,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,nccl:all_reduce,129074,[[1]],"ncclKernel_AllReduce_TREE_LL_Sum_uint8_t(ncclDevComm*, unsigned long, ncclWork*)",638217,40.666666666666664,4185.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,nccl:all_reduce,129078,[[1]],"ncclKernel_AllReduce_TREE_LL_Sum_uint8_t(ncclDevComm*, unsigned long, ncclWork*)",638266,0.6666666666666666,2179936.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::_local_scalar_dense,129083,[[]],Memcpy DtoH (Device -> Pageable),638305,0.6666666666666666,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1615): get_grad_norm_direct,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#12}::operator()() const::{lambda(double)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#12}::operator()() const::{lambda(double)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638330,56.666666666666664,179.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method norm of type object at 0x7f386de3d420>,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<double, at::native::NormTwoOps<double, double>, unsigned int, double, 4> >(at::native::ReduceOp<double, at::native::NormTwoOps<double, double>, unsigned int, double, 4>)",638346,174.0,143.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::_local_scalar_dense,129091,[[]],Memcpy DtoH (Device -> Pageable),638352,0.3333333333333333,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1615): get_grad_norm_direct,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#12}::operator()() const::{lambda(double)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#12}::operator()() const::{lambda(double)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638363,17.0,311.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method norm of type object at 0x7f386de3d420>,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<double, at::native::NormTwoOps<double, double>, unsigned int, double, 4> >(at::native::ReduceOp<double, at::native::NormTwoOps<double, double>, unsigned int, double, 4>)",638379,2.0,230.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method item of Tensor object at 0x7f37f297ea40>,0,,Memcpy DtoH (Device -> Pageable),638385,2.6666666666666665,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1615): get_grad_norm_direct,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#12}::operator()() const::{lambda(double)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#12}::operator()() const::{lambda(double)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638396,14.333333333333334,639.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,torch/_tensor.py(632): norm,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<double, at::native::NormTwoOps<double, double>, unsigned int, double, 4> >(at::native::ReduceOp<double, at::native::NormTwoOps<double, double>, unsigned int, double, 4>)",638412,2.0,453.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method item of Tensor object at 0x7f37f297ea40>,0,,Memcpy DtoH (Device -> Pageable),638418,0.3333333333333333,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::copy_,129112,"[[1], [1], []]",Memcpy HtoD (Pageable -> Device),638430,20.333333333333332,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,nccl:all_reduce,129116,[[1]],"ncclKernel_AllReduce_TREE_LL_Sum_float(ncclDevComm*, unsigned long, ncclWork*)",638448,30.333333333333332,1027.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,nccl:all_reduce,129120,[[1]],"ncclKernel_AllReduce_TREE_LL_Sum_float(ncclDevComm*, unsigned long, ncclWork*)",638497,0.3333333333333333,316.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::_local_scalar_dense,129125,[[]],Memcpy DtoH (Device -> Pageable),638536,0.3333333333333333,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method double of Tensor object at 0x7f37f296eea0>,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#12}::operator()() const::{lambda(double)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#12}::operator()() const::{lambda(double)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638561,35.666666666666664,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1615): get_grad_norm_direct,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<double, at::native::NormTwoOps<double, double>, unsigned int, double, 4> >(at::native::ReduceOp<double, at::native::NormTwoOps<double, double>, unsigned int, double, 4>)",638574,13.333333333333334,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::item,129132,[[]],Memcpy DtoH (Device -> Pageable),638580,4.666666666666667,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1615): get_grad_norm_direct,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#12}::operator()() const::{lambda(double)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#12}::operator()() const::{lambda(double)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638591,15.0,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1615): get_grad_norm_direct,0,,"void at::native::reduce_kernel<512, 1, at::native::ReduceOp<double, at::native::NormTwoOps<double, double>, unsigned int, double, 4> >(at::native::ReduceOp<double, at::native::NormTwoOps<double, double>, unsigned int, double, 4>)",638604,10.333333333333334,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::_local_scalar_dense,129141,[[]],Memcpy DtoH (Device -> Pageable),638610,4.0,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::copy_,129146,"[[1], [1], []]",Memcpy HtoD (Pageable -> Device),638622,17.666666666666668,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,nccl:all_reduce,129150,[[1]],"ncclKernel_AllReduce_TREE_LL_Sum_float(ncclDevComm*, unsigned long, ncclWork*)",638640,22.0,361.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,nccl:all_reduce,129154,[[1]],"ncclKernel_AllReduce_TREE_LL_Sum_float(ncclDevComm*, unsigned long, ncclWork*)",638689,0.6666666666666666,740.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,aten::_local_scalar_dense,129159,[[]],Memcpy DtoH (Device -> Pageable),638728,1.0,1.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in function flatten_dense_tensors>,0,,"void at::native::(anonymous namespace)::CatArrayBatchedCopy<c10::Half, unsigned int, 1, 128, 1>(c10::Half*, at::native::(anonymous namespace)::CatArrInputTensorMetadata<c10::Half, unsigned int, 128, 1>, at::native::(anonymous namespace)::TensorSizeStride<unsigned int, 4u>, int, unsigned int)",638760,65.66666666666667,682.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1766): step,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638770,0.3333333333333333,710.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1920): unscale_and_clip_grads,0,,"void at::native::vectorized_elementwise_kernel<4, at::native::AUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::AUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, at::detail::Array<char*, 2>)",638776,0.3333333333333333,797.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method multi_tensor_adam of PyCapsule object at 0x7f37f2af8240>,0,,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",638797,2.3333333333333335,467.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method multi_tensor_adam of PyCapsule object at 0x7f37f2af8240>,0,,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",638799,0.6666666666666666,464.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method multi_tensor_adam of PyCapsule object at 0x7f37f2af8240>,0,,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",638801,0.6666666666666666,469.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method multi_tensor_adam of PyCapsule object at 0x7f37f2af8240>,0,,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",638803,0.6666666666666666,465.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method multi_tensor_adam of PyCapsule object at 0x7f37f2af8240>,0,,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",638805,0.6666666666666666,474.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in method multi_tensor_adam of PyCapsule object at 0x7f37f2af8240>,0,,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",638807,0.3333333333333333,476.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,Optimizer.step#FusedAdam.step,129173,,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",638809,0.3333333333333333,262.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1766): step,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#20}::operator()() const::{lambda(c10::Half)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#20}::operator()() const::{lambda(c10::Half)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638816,0.6666666666666666,709.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,<built-in function flatten_dense_tensors>,0,,"void at::native::(anonymous namespace)::CatArrayBatchedCopy<c10::Half, unsigned int, 1, 128, 1>(c10::Half*, at::native::(anonymous namespace)::CatArrInputTensorMetadata<c10::Half, unsigned int, 128, 1>, at::native::(anonymous namespace)::TensorSizeStride<unsigned int, 4u>, int, unsigned int)",638843,2.3333333333333335,6.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1766): step,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#14}::operator()() const::{lambda(float)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638853,0.6666666666666666,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1766): step,0,,"void at::native::vectorized_elementwise_kernel<4, at::native::AUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, at::detail::Array<char*, 2> >(int, at::native::AUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, at::detail::Array<char*, 2>)",638859,0.6666666666666666,3.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,Optimizer.step#FusedAdam.step,129196,,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",638880,2.3333333333333335,37.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,deepspeed/runtime/zero/stage_1_and_2.py(1766): step,0,,"void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#20}::operator()() const::{lambda(c10::Half)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#2}::operator()() const::{lambda()#20}::operator()() const::{lambda(c10::Half)#1}, at::detail::Array<char*, 2>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",638887,0.6666666666666666,5.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,nccl:_all_gather_base,129199,[[137134080]],"ncclKernel_AllGather_RING_LL_Sum_int8_t(ncclDevComm*, unsigned long, ncclWork*)",638923,2.0,1544719.0
deepspeed/runtime/engine.py(2034): _take_model_step,0,,nccl:_all_gather_base,129201,[[55104]],"ncclKernel_AllGather_RING_LL_Sum_int8_t(ncclDevComm*, unsigned long, ncclWork*)",638972,0.6666666666666666,6137.0
