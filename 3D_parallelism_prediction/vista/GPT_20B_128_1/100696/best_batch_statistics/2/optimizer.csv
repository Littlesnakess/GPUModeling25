cpu_op_0,cpu_op_0_id,cpu_op_0_input_dim,cpu_op_1,cpu_op_1_id,cpu_op_1_input_dim,kernel,kernel_id,kernel_overhead(us),kernel_dur(us)
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518621,"[[21528576], [21528576], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518621,0,64.831
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518623,"[[21528576], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518623,1.0880533854166667,36.16
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518626,[[]],Memcpy DtoH (Device -> Pinned),518626,0.7252604166666666,1.568
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518630,"[[6144, 6144], [6144, 6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518630,34.50634765625,109.663
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518632,"[[6144, 6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518632,1.109375,54.079
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518635,[[]],Memcpy DtoH (Device -> Pinned),518635,1.3972981770833333,1.504
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518639,"[[12672, 6144], [12672, 6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518639,18.197265625,226.206
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518641,"[[12672, 6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518641,1.0773111979166667,114.815
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518644,[[]],Memcpy DtoH (Device -> Pinned),518644,1.04541015625,1.632
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518648,"[[1344], [1344], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518648,16.181315104166668,3.392
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518650,"[[1344], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518650,9.109049479166666,2.528
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518653,[[]],Memcpy DtoH (Device -> Pinned),518653,6.325358072916667,1.376
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518657,"[[6144], [6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518657,21.504069010416668,3.808
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518659,"[[6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518659,11.935546875,3.36
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518662,[[]],Memcpy DtoH (Device -> Pinned),518662,6.688151041666667,1.344
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518666,"[[4608], [4608], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518666,16.138509114583332,3.392
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518668,"[[4608], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518668,9.461263020833334,2.879
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518671,[[]],Memcpy DtoH (Device -> Pinned),518671,5.781412760416667,1.376
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518675,"[[6144], [6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518675,14.880045572916666,3.616
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518677,"[[6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518677,9.02392578125,3.424
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518680,[[]],Memcpy DtoH (Device -> Pinned),518680,6.13330078125,1.344
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518684,"[[6144], [6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518684,14.399576822916666,3.328
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518686,"[[6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518686,9.354654947916666,2.784
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518689,[[]],Memcpy DtoH (Device -> Pinned),518689,5.824055989583333,1.44
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518693,"[[6144], [6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518693,13.7275390625,3.264
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518695,"[[6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518695,8.949381510416666,3.264
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518698,[[]],Memcpy DtoH (Device -> Pinned),518698,5.15185546875,1.344
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518702,"[[6144], [6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518702,14.261393229166666,3.456
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518704,"[[6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518704,8.7568359375,2.816
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518707,[[]],Memcpy DtoH (Device -> Pinned),518707,5.86669921875,1.44
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518711,"[[6144], [6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518711,14.42138671875,3.328
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518713,"[[6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518713,9.290690104166666,3.264
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518716,[[]],Memcpy DtoH (Device -> Pinned),518716,5.706217447916667,1.344
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518720,"[[6144], [6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518720,14.0693359375,3.328
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518722,"[[6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518722,8.309244791666666,2.816
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518725,[[]],Memcpy DtoH (Device -> Pinned),518725,5.60009765625,1.376
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518729,"[[6144], [6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518729,14.100911458333334,3.52
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::sum,518731,"[[6144], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4> >(at::native::ReduceOp<float, at::native::func_wrapper_t<float, at::native::sum_functor<float, float, float>::operator()(at::TensorIterator&)::{lambda(float, float)#1}>, unsigned int, float, 4>)",518731,9.9306640625,3.264
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518734,[[]],Memcpy DtoH (Device -> Pinned),518734,5.493326822916667,1.344
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518739,"[[1], [1], []]",Memcpy HtoD (Pageable -> Device),518739,21.087565104166668,0.832
None,None,None,None,None,None,nccl:all_reduce,518743,36.52197265625,60.45
deepspeed/runtime/engine.py(2034): _take_model_step,,,record_param_comms,518742,"[[[1]], [], [], [], [], [], [], [], [], []]","ncclDevKernel_AllReduce_Sum_u8_TREE_LL(ncclDevComm*, unsigned long, ncclWork*)",518742,-20.149739583333332,60.448
None,None,None,None,None,None,nccl:all_reduce,518747,35.263346354166664,794393.21
deepspeed/runtime/engine.py(2034): _take_model_step,,,record_param_comms,518746,"[[[1]], [], [], [], [], [], [], [], [], []]","ncclDevKernel_AllReduce_Sum_u8_TREE_LL(ncclDevComm*, unsigned long, ncclWork*)",518746,-264797.736328125,794393.208
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518752,[[]],Memcpy DtoH (Device -> Pinned),518752,0.8639322916666666,1.44
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518756,"[[21528576], [21528576], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#6}::operator()() const::{lambda(double)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#6}::operator()() const::{lambda(double)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518756,42.677083333333336,100.063
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::linalg_vector_norm,518757,"[[21528576], [], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<double, at::native::NormTwoOps<double, double, double>, unsigned int, double, 4> >(at::native::ReduceOp<double, at::native::NormTwoOps<double, double, double>, unsigned int, double, 4>)",518757,1.0773111979166667,61.055
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518760,[[]],Memcpy DtoH (Device -> Pinned),518760,1.2373046875,1.472
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518764,"[[6144, 6144], [6144, 6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#6}::operator()() const::{lambda(double)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#6}::operator()() const::{lambda(double)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518764,17.237141927083332,173.982
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::linalg_vector_norm,518765,"[[6144, 6144], [], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<double, at::native::NormTwoOps<double, double, double>, unsigned int, double, 4> >(at::native::ReduceOp<double, at::native::NormTwoOps<double, double, double>, unsigned int, double, 4>)",518765,1.04541015625,94.655
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518768,[[]],Memcpy DtoH (Device -> Pinned),518768,0.50146484375,1.6
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518772,"[[12672, 6144], [12672, 6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#6}::operator()() const::{lambda(double)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#6}::operator()() const::{lambda(double)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518772,16.298502604166668,358.461
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::linalg_vector_norm,518773,"[[12672, 6144], [], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<double, at::native::NormTwoOps<double, double, double>, unsigned int, double, 4> >(at::native::ReduceOp<double, at::native::NormTwoOps<double, double, double>, unsigned int, double, 4>)",518773,1.0348307291666667,190.814
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518776,[[]],Memcpy DtoH (Device -> Pinned),518776,0.4265950520833333,1.472
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518781,"[[1], [1], []]",Memcpy HtoD (Pageable -> Device),518781,21.493326822916668,0.768
None,None,None,None,None,None,nccl:all_reduce,518785,35.3486328125,44.162
deepspeed/runtime/engine.py(2034): _take_model_step,,,record_param_comms,518784,"[[[1]], [], [], [], [], [], [], [], [], []]","ncclDevKernel_AllReduce_Sum_f32_TREE_LL(ncclDevComm*, unsigned long, ncclWork*)",518784,-14.720377604166666,44.16
None,None,None,None,None,None,nccl:all_reduce,518789,38.708658854166664,532.957
deepspeed/runtime/engine.py(2034): _take_model_step,,,record_param_comms,518788,"[[[1]], [], [], [], [], [], [], [], [], []]","ncclDevKernel_AllReduce_Sum_f32_TREE_LL(ncclDevComm*, unsigned long, ncclWork*)",518788,-177.65201822916666,532.955
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518794,[[]],Memcpy DtoH (Device -> Pinned),518794,2.0159505208333335,1.344
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518798,"[[4608], [4608], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#6}::operator()() const::{lambda(double)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#6}::operator()() const::{lambda(double)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518798,35.05029296875,3.648
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::linalg_vector_norm,518799,"[[4608], [], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<double, at::native::NormTwoOps<double, double, double>, unsigned int, double, 4> >(at::native::ReduceOp<double, at::native::NormTwoOps<double, double, double>, unsigned int, double, 4>)",518799,22.975911458333332,3.744
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518802,[[]],Memcpy DtoH (Device -> Pinned),518802,9.023600260416666,1.44
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518806,"[[6144], [6144], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#6}::operator()() const::{lambda(double)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#6}::operator()() const::{lambda(double)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518806,17.1201171875,3.552
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::linalg_vector_norm,518807,"[[6144], [], [], [], []]","void at::native::reduce_kernel<512, 1, at::native::ReduceOp<double, at::native::NormTwoOps<double, double, double>, unsigned int, double, 4> >(at::native::ReduceOp<double, at::native::NormTwoOps<double, double, double>, unsigned int, double, 4>)",518807,14.3466796875,3.296
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518810,[[]],Memcpy DtoH (Device -> Pinned),518810,7.06103515625,1.312
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518815,"[[1], [1], []]",Memcpy HtoD (Pageable -> Device),518815,20.9599609375,0.864
None,None,None,None,None,None,nccl:all_reduce,518819,34.271484375,38.53
deepspeed/runtime/engine.py(2034): _take_model_step,,,record_param_comms,518818,"[[[1]], [], [], [], [], [], [], [], [], []]","ncclDevKernel_AllReduce_Sum_f32_TREE_LL(ncclDevComm*, unsigned long, ncclWork*)",518818,-12.842936197916666,38.528
None,None,None,None,None,None,nccl:all_reduce,518823,36.52197265625,1503.093
deepspeed/runtime/engine.py(2034): _take_model_step,,,record_param_comms,518822,"[[[1]], [], [], [], [], [], [], [], [], []]","ncclDevKernel_AllReduce_Sum_f32_TREE_LL(ncclDevComm*, unsigned long, ncclWork*)",518822,-501.0304361979167,1503.091
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::_local_scalar_dense,518828,[[]],Memcpy DtoH (Device -> Pinned),518828,1.919921875,1.344
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::cat,518833,"[[[21528576], [37748736], [77856768]], []]","void at::native::(anonymous namespace)::CatArrayBatchedCopy_contig<at::native::(anonymous namespace)::OpaqueType<2u>, unsigned int, 1, 128, 1>(at::native::(anonymous namespace)::OpaqueType<2u>*, at::native::(anonymous namespace)::CatArrInputTensorMetadata<at::native::(anonymous namespace)::OpaqueType<2u>, unsigned int, 128, 1>, at::native::(anonymous namespace)::TensorSizeStride<unsigned int, 4u>, int, unsigned int)",518833,67.33837890625,349.661
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518837,"[[137134080], [137134080], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518837,0.46923828125,399.868
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::mul_,518838,"[[137134080], []]","void at::native::vectorized_elementwise_kernel<4, at::native::AUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, std::array<char*, 2ul> >(int, at::native::AUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, std::array<char*, 2ul>)",518838,0.6826171875,301.086
None,None,None,None,None,None,Optimizer.step#FusedAdam.step,518839,1.3863932291666667,1262.072
None,None,None,None,None,None,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",,-420.6902669270833,189.278
None,None,None,None,None,None,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",,0.4586588541666667,192.863
None,None,None,None,None,None,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",,0.4694010416666667,189.438
None,None,None,None,None,None,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",,0.49072265625,194.047
None,None,None,None,None,None,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",,0.5333658854166666,194.462
None,None,None,None,None,None,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",,0.4373372395833333,189.726
None,None,None,None,None,None,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",,0.6612955729166666,103.104
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518840,"[[137134080], [137134080], []]","void at::native::vectorized_elementwise_kernel<4, at::native::float16_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda(float)#1}, std::array<char*, 2ul> >(int, at::native::float16_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda(float)#1}, std::array<char*, 2ul>)",518840,0.693359375,226.558
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::cat,518852,"[[[1344], [6144], [4608], [6144], [6144], [6144], [6144], [6144], [6144], [6144]], []]","void at::native::(anonymous namespace)::CatArrayBatchedCopy_contig<at::native::(anonymous namespace)::OpaqueType<2u>, unsigned int, 1, 128, 1>(at::native::(anonymous namespace)::OpaqueType<2u>*, at::native::(anonymous namespace)::CatArrInputTensorMetadata<at::native::(anonymous namespace)::OpaqueType<2u>, unsigned int, 128, 1>, at::native::(anonymous namespace)::TensorSizeStride<unsigned int, 4u>, int, unsigned int)",518852,1.30126953125,4.032
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518856,"[[55104], [55104], []]","void at::native::unrolled_elementwise_kernel<at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, 4, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1> >(int, at::native::direct_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda()#3}::operator()() const::{lambda()#7}::operator()() const::{lambda(float)#1}, std::array<char*, 2ul>, TrivialOffsetCalculator<1, unsigned int>, TrivialOffsetCalculator<1, unsigned int>, at::native::memory::LoadWithCast<1>, at::native::memory::StoreWithCast<1>)",518856,0.4265950520833333,2.88
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::mul_,518857,"[[55104], []]","void at::native::vectorized_elementwise_kernel<4, at::native::AUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, std::array<char*, 2ul> >(int, at::native::AUnaryFunctor<float, float, float, at::native::binary_internal::MulFunctor<float> >, std::array<char*, 2ul>)",518857,0.416015625,1.408
None,None,None,None,None,None,Optimizer.step#FusedAdam.step,518858,1.3219401041666667,25.57
None,None,None,None,None,None,"void multi_tensor_apply_kernel<TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float>(int, int volatile*, TensorListMetadata<4>, AdamFunctor<float>, float, float, float, float, float, float, adamMode_t, float)",,-8.52294921875,25.568
deepspeed/runtime/engine.py(2034): _take_model_step,,,aten::copy_,518859,"[[55104], [55104], []]","void at::native::vectorized_elementwise_kernel<4, at::native::float16_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda(float)#1}, std::array<char*, 2ul> >(int, at::native::float16_copy_kernel_cuda(at::TensorIteratorBase&)::{lambda(float)#1}, std::array<char*, 2ul>)",518859,0.3841145833333333,1.664
None,None,None,None,None,None,nccl:_all_gather_base,518862,1.5462239583333333,39498.588
deepspeed/runtime/engine.py(2034): _take_model_step,,,record_param_comms,518861,"[[137134080], [], [], [], [], [], [], [], [], []]","ncclDevKernel_AllGather_RING_LL(ncclDevComm*, unsigned long, ncclWork*)",518861,-13166.195638020834,39498.586
None,None,None,None,None,None,nccl:_all_gather_base,518866,0.5970052083333334,131.969
deepspeed/runtime/engine.py(2034): _take_model_step,,,record_param_comms,518865,"[[55104], [], [], [], [], [], [], [], [], []]","ncclDevKernel_AllGather_RING_LL(ncclDevComm*, unsigned long, ncclWork*)",518865,-43.9892578125,131.967
